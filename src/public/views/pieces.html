<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Chess Insights - The Pieces</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="images/favicon/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="images/favicon/favicon.svg">
    <link rel="shortcut icon" href="images/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-touch-icon.png">
    <link rel="manifest" href="images/favicon/site.webmanifest">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./styles/style.css">
    <link rel="stylesheet" href="./styles/pieces-style.css">
    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/d3@7/dist/d3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/plotly.js-dist@2.24.1/plotly.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chess.js@1.0.0-beta.6/dist/chess.min.js"></script>
    <script type="importmap">
        {
          "imports": {
            "three":  "https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js",
            "three/": "https://cdn.jsdelivr.net/npm/three@0.158.0/"
          }
        }
    </script>
</head>
<body>
    <!-- Header Nav -->
    <nav>
        <div class="nav-container">
            <a href="/" class="logo">
                <img src="images/logo.svg" alt="Chess Insights Logo">
                <span class="logo-text">Chess Insights</span>
            </a>
            <div class="nav-links">
                <div class="nav-item">
                    <a href="/" class="nav-link">
                        Dashboard
                        <!-- <span class="dropdown-arrow">▼</span> -->
                    </a>
                    <div class="dropdown-menu">
                        <a href="/#dashboard" class="dropdown-link">Overview</a>
                        <a href="/#player-stats" class="dropdown-link">Player Stats</a>
                        <a href="/#" class="dropdown-link">Recent Games</a>
                        <a href="/#" class="dropdown-link">Performance Trends</a>
                        <a href="/#" class="dropdown-link">Rating History</a>
                    </div>
                </div>
                
                <div class="nav-item">
                    <a href="/analysis" class="nav-link">
                        Game Analysis
                        <!-- <span class="dropdown-arrow">▼</span> -->
                    </a>
                    <div class="dropdown-menu">
                        <a href="/analysis#game-analysis" class="dropdown-link">Analyze Game</a>
                        <a href="/analysis#" class="dropdown-link">Opening Explorer</a>
                        <a href="/analysis#" class="dropdown-link">Engine Analysis</a>
                        <a href="/analysis#" class="dropdown-link">Blunder Report</a>
                        <a href="/analysis#" class="dropdown-link">Position Database</a>
                    </div>
                </div>
                <div class="nav-item">
                    <a href="/pieces" class="nav-link">Pieces</a>
                </div>
                <div class="nav-item">
                    <a href="/board" class="nav-link">Board</a>
                </div>
            </div>
            <button class="mobile-menu-button" onclick="toggleMobileMenu()">☰</button>
        </div>

        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-nav-item">
                <a href="/" class="mobile-nav-link" onclick="toggleMobileDropdown('dashboard')">
                    Dashboard
                    <button class="mobile-toggle">▼</button>
                </a>
                <div class="mobile-dropdown" id="dashboard-dropdown">
                    <a href="/#dashboard" class="mobile-dropdown-link">Overview</a>
                    <a href="/#player-stats" class="mobile-dropdown-link">Player Stats</a>
                    <a href="/#" class="mobile-dropdown-link">Recent Games</a>
                    <a href="/#" class="mobile-dropdown-link">Performance Trends</a>
                    <a href="/#" class="mobile-dropdown-link">Rating History</a>
                </div>
            </div>
            <div class="mobile-nav-item">
                <a href="/analysis" class="mobile-nav-link" onclick="toggleMobileDropdown('analysis')">
                    Game Analysis
                    <button class="mobile-toggle">▼</button>
                </a>
                <div class="mobile-dropdown" id="analysis-dropdown">
                    <a href="/analysis#game-analysis" class="mobile-dropdown-link">Analyze Game</a>
                    <a href="/analysis#" class="mobile-dropdown-link">Opening Explorer</a>
                    <a href="/analysis#" class="mobile-dropdown-link">Engine Analysis</a>
                    <a href="/analysis#" class="mobile-dropdown-link">Blunder Report</a>
                    <a href="/analysis#" class="mobile-dropdown-link">Position Database</a>
                </div>
            </div>
            <a href="/pieces" class="mobile-nav-link">Pieces</a>
            <a href="/board" class="mobile-nav-link">Board</a>
        </div>
    </nav>

    <div class="hero">
        <h1 class="hero-title">The Pieces</h1>
        <p class="hero-subtitle">Discover the unique roles and movements of each chess piece</p>
    </div>

    <div class="slideshow-container">
        <!-- King Slide -->
        <div class="slide active">
            <div class="slide-content-wrapper">
                <div class="slide-image-container">
                    <img src="../images/pieces/king.png" alt="Chess King" class="piece-image">
                </div>
                <div class="slide-text">
                    <h2 class="piece-name">King</h2>
                    <p class="piece-description">
                        The most important piece on the board. The King can move one square in any direction—horizontally, vertically, or diagonally. While not the most powerful piece, losing your King means losing the game. The King must be protected at all costs and can participate in the special move called castling.
                    </p>
                </div>
            </div>
        </div>

        <!-- Queen Slide -->
        <div class="slide">
            <div class="slide-content-wrapper">
                <div class="slide-image-container">
                    <img src="../images/pieces/queen.png" alt="Chess Queen" class="piece-image">
                </div>
                <div class="slide-text">
                    <h2 class="piece-name">Queen</h2>
                    <p class="piece-description">
                        The most powerful piece on the chessboard. The Queen combines the movement of a Rook and Bishop, moving any number of squares horizontally, vertically, or diagonally. With her incredible range and flexibility, the Queen is often the key to launching devastating attacks and controlling the center of the board.
                    </p>
                </div>
            </div>
        </div>

        <!-- Rook Slide -->
        <div class="slide">
            <div class="slide-content-wrapper">
                <div class="slide-image-container">
                    <img src="../images/pieces/rook.png" alt="Chess Rook" class="piece-image">
                </div>
                <div class="slide-text">
                    <h2 class="piece-name">Rook</h2>
                    <p class="piece-description">
                        A powerful long-range piece that moves any number of squares horizontally or vertically. Rooks are particularly effective on open files and ranks, often dominating the endgame. They participate in the special castling move with the King and are essential for controlling key squares and launching attacks.
                    </p>
                </div>
            </div>
        </div>

        <!-- Bishop Slide -->
        <div class="slide">
            <div class="slide-content-wrapper">
                <div class="slide-image-container">
                    <img src="../images/pieces/bishop.png" alt="Chess Bishop" class="piece-image">
                </div>
                <div class="slide-text">
                    <h2 class="piece-name">Bishop</h2>
                    <p class="piece-description">
                        The Bishop moves diagonally any number of squares and is bound to squares of one color throughout the game. Each player starts with one light-squared and one dark-squared Bishop. Bishops work best on open diagonals and are particularly powerful when working together as a "Bishop pair."
                    </p>
                </div>
            </div>
        </div>

        <!-- Knight Slide -->
        <div class="slide">
            <div class="slide-content-wrapper">
                <div class="slide-image-container">
                    <img src="../images/pieces/knight.png" alt="Chess Knight" class="piece-image">
                </div>
                <div class="slide-text">
                    <h2 class="piece-name">Knight</h2>
                    <p class="piece-description">
                        The most unique piece on the board, moving in an "L" shape—two squares in one direction and one square perpendicular. Knights are the only pieces that can jump over other pieces, making them excellent for surprise attacks and navigating crowded positions. They're particularly effective in closed positions.
                    </p>
                </div>
            </div>
        </div>

        <!-- Pawn Slide -->
        <div class="slide">
            <div class="slide-content-wrapper">
                <div class="slide-image-container">
                    <img src="../images/pieces/pawn.png" alt="Chess Pawn" class="piece-image">
                </div>
                <div class="slide-text">
                    <h2 class="piece-name">Pawn</h2>
                    <p class="piece-description">
                        The foot soldiers of chess. Pawns move forward one square, or two squares from their starting position. They capture diagonally and can be promoted to any piece (except King) upon reaching the opposite end of the board. Despite being the least valuable piece, pawns form the backbone of chess strategy and structure.
                    </p>
                </div>
            </div>
        </div>

        <!-- Navigation buttons -->
        <button class="nav-button prev" onclick="changeSlide(-1)">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button class="nav-button next" onclick="changeSlide(1)">
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>

    <!-- Dots indicator -->
    <div class="dots-container">
        <span class="dot active" onclick="currentSlide(1)"></span>
        <span class="dot" onclick="currentSlide(2)"></span>
        <span class="dot" onclick="currentSlide(3)"></span>
        <span class="dot" onclick="currentSlide(4)"></span>
        <span class="dot" onclick="currentSlide(5)"></span>
        <span class="dot" onclick="currentSlide(6)"></span>
    </div>


    <!-- Movement Section -->
    <div class="movement-section">
        <div class="movement-container">
        <h2 class="movement-title" id="movement-title">How the King Moves</h2>
        <div class="movement-board" id="movement-board">
            <!-- Board will be generated by JavaScript -->
        </div>
        <div class="movement-legend">
            <div class="legend-item">
            <div class="legend-color legend-piece"></div>
            <span>Current Position</span>
            </div>
            <div class="legend-item">
            <div class="legend-color legend-move"></div>
            <span>Possible Moves</span>
            </div>
            <div class="legend-item">
            <div class="legend-color legend-attack"></div>
            <span>Attack Moves</span>
            </div>
        </div>
        </div>
    </div>

    <script>
        let slideIndex = 1;

        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('show');
        });

        function showSlide(n) {
            const slides = document.getElementsByClassName('slide');
            const dots = document.getElementsByClassName('dot');
            
            if (n > slides.length) { slideIndex = 1; }
            if (n < 1) { slideIndex = slides.length; }
            
            // Hide all slides
            for (let i = 0; i < slides.length; i++) {
                slides[i].classList.remove('active');
            }
            
            // Remove active class from all dots
            for (let i = 0; i < dots.length; i++) {
                dots[i].classList.remove('active');
            }
            
            // Show current slide and activate corresponding dot
            slides[slideIndex - 1].classList.add('active');
            dots[slideIndex - 1].classList.add('active');
        }

        function changeSlide(n) {
            slideIndex += n;
            showSlide(slideIndex);
        }

        function currentSlide(n) {
            slideIndex = n;
            showSlide(slideIndex);
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(event) {
            if (event.key === 'ArrowLeft') {
                changeSlide(-1);
            } else if (event.key === 'ArrowRight') {
                changeSlide(1);
            }
        });

        // Touch/swipe support for mobile
        let startX = 0;
        let endX = 0;

        document.addEventListener('touchstart', function(event) {
            startX = event.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', function(event) {
            endX = event.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const threshold = 50;
            const diff = startX - endX;
            
            if (Math.abs(diff) > threshold) {
                if (diff > 0) {
                    changeSlide(1);
                } else {
                    changeSlide(-1);
                }
            }
        }
    </script>
    <script>
        // Movement patterns for each piece
        const movementPatterns = {
        1: { // King
            title: "How the King Moves",
            piece: "♔",
            position: [3, 3],
            moves: [[2,2],[2,3],[2,4],[3,2],[3,4],[4,2],[4,3],[4,4]],
            attacks: []
        },
        2: { // Queen
            title: "How the Queen Moves",
            piece: "♕",
            position: [3, 3],
            moves: [
            [0,3],[1,3],[2,3],[4,3],[5,3],[6,3],[7,3], // vertical
            [3,0],[3,1],[3,2],[3,4],[3,5],[3,6],[3,7], // horizontal
            [0,0],[1,1],[2,2],[4,4],[5,5],[6,6],[7,7], // diagonal 1
            [0,6],[1,5],[2,4],[4,2],[5,1],[6,0] // diagonal 2
            ],
            attacks: []
        },
        3: { // Rook
            title: "How the Rook Moves",
            piece: "♖",
            position: [3, 3],
            moves: [
            [0,3],[1,3],[2,3],[4,3],[5,3],[6,3],[7,3], // vertical
            [3,0],[3,1],[3,2],[3,4],[3,5],[3,6],[3,7] // horizontal
            ],
            attacks: []
        },
        4: { // Bishop
            title: "How the Bishop Moves",
            piece: "♗",
            position: [3, 3],
            moves: [
            [0,0],[1,1],[2,2],[4,4],[5,5],[6,6],[7,7], // diagonal 1
            [0,6],[1,5],[2,4],[4,2],[5,1],[6,0] // diagonal 2
            ],
            attacks: []
        },
        5: { // Knight
            title: "How the Knight Moves",
            piece: "♘",
            position: [3, 3],
            moves: [[1,2],[1,4],[2,1],[2,5],[4,1],[4,5],[5,2],[5,4]],
            attacks: []
        },
        6: { // Pawn
            title: "How the Pawn Moves",
            piece: "♙",
            position: [5, 3],
            moves: [[4,3],[3,3]], // forward moves (including initial two-square move)
            attacks: [[4,2],[4,4]] // diagonal attacks
        }
        };

        function createBoard() {
        const board = document.getElementById('movement-board');
        board.innerHTML = '';
        
        for (let row = 0; row < 8; row++) {
            const boardRow = document.createElement('div');
            boardRow.className = 'board-row';
            
            for (let col = 0; col < 8; col++) {
            const square = document.createElement('div');
            square.className = `board-square ${(row + col) % 2 === 0 ? 'light' : 'dark'}`;
            square.dataset.row = row;
            square.dataset.col = col;
            boardRow.appendChild(square);
            }
            
            board.appendChild(boardRow);
        }
        }

        function updateMovementDisplay() {
        const pattern = movementPatterns[slideIndex];
        if (!pattern) return;
        
        // Update title
        document.getElementById('movement-title').textContent = pattern.title;
        
        // Clear all special classes
        const squares = document.querySelectorAll('.board-square');
        squares.forEach(square => {
            square.classList.remove('piece-position', 'possible-move', 'attack-move');
            square.textContent = '';
        });
        
        // Add piece to its position
        const pieceSquare = document.querySelector(`[data-row="${pattern.position[0]}"][data-col="${pattern.position[1]}"]`);
        if (pieceSquare) {
            pieceSquare.classList.add('piece-position');
            pieceSquare.textContent = pattern.piece;
        }
        
        // Add possible moves
        pattern.moves.forEach(([row, col]) => {
            const square = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
            if (square) {
            square.classList.add('possible-move');
            }
        });
        
        // Add attack moves
        pattern.attacks.forEach(([row, col]) => {
            const square = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
            if (square) {
            square.classList.add('attack-move');
            }
        });
        }

        // Update the existing showSlide function to include movement display
        function showSlide(n) {
        const slides = document.getElementsByClassName('slide');
        const dots = document.getElementsByClassName('dot');
        
        if (n > slides.length) { slideIndex = 1; }
        if (n < 1) { slideIndex = slides.length; }
        
        // Hide all slides
        for (let i = 0; i < slides.length; i++) {
            slides[i].classList.remove('active');
        }
        
        // Remove active class from all dots
        for (let i = 0; i < dots.length; i++) {
            dots[i].classList.remove('active');
        }
        
        // Show current slide and activate corresponding dot
        slides[slideIndex - 1].classList.add('active');
        dots[slideIndex - 1].classList.add('active');
        
        // Update movement display
        updateMovementDisplay();
        }

        // Initialize board when page loads
        document.addEventListener('DOMContentLoaded', function() {
        createBoard();
        updateMovementDisplay();
        });
    </script>
</body>
</html>